{% load i18n %} <!DOCTYPE html>
<html lang="en-US">
  <header>
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
  </header>
  <body>
    <h1>Categoria por mês no ano de {{ year }}</h1>

    <div class="d-flex flex-wrap" style="height: 100%;">
      {% for d in data %}
      <div id="id_{{d.month}}"></div>
      {% endfor %}
    </div>

    <script
      type="text/javascript"
      src="https://www.gstatic.com/charts/loader.js"
    ></script>

    <script type="text/javascript">
      // Load google charts
      google.charts.load("current", { packages: ["corechart"] });
      google.charts.setOnLoadCallback(drawChart);

      // Draw the chart and set the chart values
      function drawChart() {

        {% get_current_language as LANGUAGE_CODE %}
        <!-- Current language: {{ LANGUAGE_CODE }} -->

        {% language 'en' %}
        {% get_current_language as LANGUAGE_CODE %}
        <!-- Current language: {{ LANGUAGE_CODE }} -->

        // var data = google.visualization.arrayToDataTable([
        //   ["Task", "Hours per Day"],
        //   {% for o in data %}
        //         ["{{o.0}}",{{ o.1 | floatformat:'2' }}],
        //     {% endfor %}
        // ]);


        {% for d in data %}

          var data{{d.number}} = google.visualization.arrayToDataTable([
          ["Task", "Hours per Day"],
          {% for i in d.data %}
                ["{{i.0}}",{{ i.1 | floatformat:'2' }}],
            {% endfor %}
          ]);

          var options{{d.number}} = { title: "{{d.month}}", width: 550, height: 400 };

          var chart{{d.number}} = new google.visualization.PieChart(
            document.getElementById("id_{{d.month}}")
          );
          chart{{d.number}}.draw(data{{d.number}}, options{{d.number}});

        {% endfor %}

        {% endlanguage %}

        // Optional; add a title and set the width and height of the chart
      //   var options = { title: "My Average Day", width: 550, height: 400 };
      //   var options2 = { title: "Outro mês", width: 550, height: 400 };

      //   // Display the chart inside the <div> element with id="piechart"
      //   var chart = new google.visualization.PieChart(
      //     document.getElementById("piechart")
      //   );
      //   chart.draw(data, options);

      //   var chart2 = new google.visualization.PieChart(
      //     document.getElementById("piechart2")
      //   );
      //   chart2.draw(data, options2);
      }
    </script>
  </body>
</html>
